# mimizu

## これは何

日本語全文検索機能付きpdfビューア


## 機能

- pdfファイルが含まれるフォルダを指定すると検索インデックスを作成

- 検索窓から単語を入力すると、マッチする文書のリストと概要が表示される

- 文書をクリックするとpdfファイルが開き、当該ページを表示する

- ヒストリ、ブックマークなど

## 実装

- Python + Whoosh で検索部分を作る + Whooshはpure pythonで書かれた全文テキスト検索モジュールである

- 簡易なn-gram検索にする

- 検索UIとビューアはJavascript + Electronで作る

- 当初全文検索エンジンのgroongaもしくはElasticSearchをJSから呼んで使うことを検討したが以下の理由からやめた

    - JSバインディングのnroongaが古くなっていて使えないっぽい
        + rubyから扱う例が多いようだ

    - Windowsでパッケージにまとめてインストールするのが手間
        + サイズがでかい

- 機能的にはおそらく、groongaのC++ライブラリを使って全部C++で書くのがベスト。しかし学習コストが過大・・・

## 設計

- 検索クラスのメソッド
    + indexを作成、初期化する
    + タイトル、テキスト文字列を受け取り、indexに追加する
    + pdfファイルのパスを受け取り、テキストを抽出する
    + クエリ文字列を受け取り、マッチした文書のファイル名とハイライトつき文字列のJSONを返す

- UI部分
    + フォームから受け取った文字列を検索部分に投げる。結果をJSONで受け取り、一覧をhtmlで表示
    + 項目をクリックすると、pdfを開いてヒットしたページをハイライトつき表示する

## TODO

- ngramの最適サイズについて調べる

- テストを書け
