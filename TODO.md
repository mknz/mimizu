# TODO

## pdf.js
- pdfにおける日本語処理にはcmap読み込みが必要

- pdf.jsはwebworker内でcmapの読み込みを行う

- nodeを使ってコマンドラインツールとして実行したときにwebworkerが使用できない

- とりあえずelectronで動かす・・・

## テキスト処理
- 文章内に無意味な半角スペースが含まれている場合の処理

- テキストブロックのつながりの自動判定
  + 大変なのであとまわし

## known problems
- 特定のpdfを変換しようとするとメモリエラーで落ちる
 + 埋め込みフォントの不整合が原因

- 機種依存文字がときどき化けてテキスト出力される

## TODO
- グローバルインポートせずにpdf.jsを動かす

## work log
2017/01/17 PageMakerから作成したpdfがpdf.jsで変換できない問題、PDFminerの使用で解決
2017/01/17 PDFminerは縦書きを横書きに変換してくれるが、pdf.jsだと変換されない
2017/01/17 PDFminerを使った場合、同一のテキストが複数回繰り返される問題が判明
2017/01/17 テキストが数十MB程度だとgrepで一瞬で検索可能とわかる。whooshを使わなくてもいいのでは
2017/01/17 kuromojiでトークナイズしてfuse.jsでfuzzy search案
2017/01/17 辞書にない固有名詞が多いので形態素解析でトークナイズするのは微妙か
2017/01/17 そもそもfuse.jsはトークナイザに正規表現しか受け付けない -> 却下
2017/01/17 GNU grepのWindows版を発見
2017/01/18 whooshで19MBのテキストからインデックス作成。ngram 2-4 760MB
2017/01/18 whoosh検索遅い。grepは一瞬
2017/01/18 whooshで19MBのテキストからインデックス作成。ngram 2-2 107MB
2017/01/18 bigramのみだと検索はgrep並みに速いのでwhoosh bigramでよさそう
2017/01/18 ハイライト部分はマークアップされたテキストで返ってくるのでそれを単にビューアに差しこめばいい
2017/01/18 全文マッチさせるときは""で囲えばよい
2017/01/18 elm-electronをベースにGUIを作りはじめる。elmを任意のdom要素にembedできることを確認
2017/01/18 elmとelectronはipcでやりとりする。elmからelectron経由でwhooshと通信可能
2017/01/19 PageMaker6.5で出力した特定のpdfがpdf.jsで変換できない問題、フォントを置換して再出力してもらった結果、変換できるようになった
2017/01/21 pdf viewer部分はiframeで表示する。Elmとportで通信してファイル名を受け取り、iframe部分を更新する
2017/01/21 Elmのportの動作を確認
2017/01/21 whooshをfalconでAPIサーバ化する
2017/01/25 検索結果1位のpdfファイルを即座に開くところまでできた
